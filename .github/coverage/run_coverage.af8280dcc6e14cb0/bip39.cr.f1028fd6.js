var data = {lines:[
{"lineNum":"    1","line":"# Copyright 2021-2022 Afri Schoedon"},
{"lineNum":"    2","line":"#"},
{"lineNum":"    3","line":"# Licensed under the Apache License, Version 2.0 (the \"License\");"},
{"lineNum":"    4","line":"# you may not use this file except in compliance with the License."},
{"lineNum":"    5","line":"# You may obtain a copy of the License at"},
{"lineNum":"    6","line":"#"},
{"lineNum":"    7","line":"#     http://www.apache.org/licenses/LICENSE-2.0"},
{"lineNum":"    8","line":"#"},
{"lineNum":"    9","line":"# Unless required by applicable law or agreed to in writing, software"},
{"lineNum":"   10","line":"# distributed under the License is distributed on an \"AS IS\" BASIS,"},
{"lineNum":"   11","line":"# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."},
{"lineNum":"   12","line":"# See the License for the specific language governing permissions and"},
{"lineNum":"   13","line":"# limitations under the License."},
{"lineNum":"   14","line":""},
{"lineNum":"   15","line":"require \"big\""},
{"lineNum":"   16","line":"require \"random\""},
{"lineNum":"   17","line":"require \"openssl\""},
{"lineNum":"   18","line":""},
{"lineNum":"   19","line":"require \"./util\""},
{"lineNum":"   20","line":"require \"./version\""},
{"lineNum":"   21","line":""},
{"lineNum":"   22","line":"module Bip0039"},
{"lineNum":"   23","line":""},
{"lineNum":"   24","line":"  # implements bip-39 mnemonics"},
{"lineNum":"   25","line":"  # https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki"},
{"lineNum":"   26","line":"  class Mnemonic"},
{"lineNum":"   27","line":""},
{"lineNum":"   28","line":"    # the entropy of the mnemonic"},
{"lineNum":"   29","line":"    getter ent : Int32"},
{"lineNum":"   30","line":""},
{"lineNum":"   31","line":"    # the random seed of the mnemonic"},
{"lineNum":"   32","line":"    getter seed : BigInt"},
{"lineNum":"   33","line":""},
{"lineNum":"   34","line":"    # generate a random 128-bit mnemonic"},
{"lineNum":"   35","line":"    def initialize"},
{"lineNum":"   36","line":"      @ent = 128"},
{"lineNum":"   37","line":"      @seed = generate_random_seed(@seed)"},
{"lineNum":"   38","line":"    end"},
{"lineNum":"   39","line":""},
{"lineNum":"   40","line":"    # generate a randome mneminuc of ENT bits"},
{"lineNum":"   41","line":"    def initialize(ent : Int32 = 128)","class":"lineCov","hits":"7","order":"1","possible_hits":"7",},
{"lineNum":"   42","line":"      if ent % 32 != 0 || ent < 128 || ent > 256","class":"linePartCov","hits":"3","order":"2","possible_hits":"4",},
{"lineNum":"   43","line":"        raise \"Can only generate seeds of 128/160/192/224/256-bit entropy\"","class":"linePartCov","hits":"1","order":"3","possible_hits":"2",},
{"lineNum":"   44","line":"      end"},
{"lineNum":"   45","line":"      @ent = ent","class":"lineCov","hits":"2","order":"43","possible_hits":"2",},
{"lineNum":"   46","line":"      @seed = generate_random_seed(ent)","class":"lineCov","hits":"2","order":"44","possible_hits":"2",},
{"lineNum":"   47","line":"    end"},
{"lineNum":"   48","line":""},
{"lineNum":"   49","line":"    # restore a mnemonic from a given hex string seed"},
{"lineNum":"   50","line":"    def initialize(hex : String)","class":"lineCov","hits":"3","order":"4","possible_hits":"3",},
{"lineNum":"   51","line":"      if hex.size % 8 != 0 || hex.size < 32 || hex.size > 64","class":"lineCov","hits":"2","order":"5","possible_hits":"2",},
{"lineNum":"   52","line":"        raise \"Can only parse 128/160/192/224/256-bit hex seeds\"","class":"lineCov","hits":"1","order":"6","possible_hits":"1",},
{"lineNum":"   53","line":"      end"},
{"lineNum":"   54","line":"      @ent = hex.size * 4","class":"linePartCov","hits":"1","order":"71","possible_hits":"2",},
{"lineNum":"   55","line":"      @seed = BigInt.new hex, 16","class":"lineCov","hits":"1","order":"72","possible_hits":"1",},
{"lineNum":"   56","line":"    end"},
{"lineNum":"   57","line":""},
{"lineNum":"   58","line":"    # restore a mnemonic of given entropy from given seed"},
{"lineNum":"   59","line":"    def initialize(seed : BigInt, ent : Int32 = 128)","class":"lineCov","hits":"4","order":"7","possible_hits":"4",},
{"lineNum":"   60","line":"      if ent % 32 != 0 || ent < 128 || ent > 256","class":"lineCov","hits":"2","order":"8","possible_hits":"2",},
{"lineNum":"   61","line":"        raise \"Can only recover seeds of 128/160/192/224/256-bit entropy\"","class":"lineCov","hits":"1","order":"9","possible_hits":"1",},
{"lineNum":"   62","line":"      end"},
{"lineNum":"   63","line":"      @ent = ent","class":"lineCov","hits":"1","order":"49","possible_hits":"1",},
{"lineNum":"   64","line":"      @seed = seed","class":"lineCov","hits":"1","order":"50","possible_hits":"1",},
{"lineNum":"   65","line":"    end"},
{"lineNum":"   66","line":""},
{"lineNum":"   67","line":"    # restore a mnemonic from a given bip-39 phrase"},
{"lineNum":"   68","line":"    def initialize(phrase : Array(String))","class":"lineCov","hits":"3","order":"10","possible_hits":"3",},
{"lineNum":"   69","line":"      raise \"Invalid seed phrase: wrong size\" if phrase.size < 12 || phrase.size > 24 || phrase.size % 3 != 0","class":"lineCov","hits":"2","order":"11","possible_hits":"2",},
{"lineNum":"   70","line":""},
{"lineNum":"   71","line":"      # load the english dictionary for bip-39"},
{"lineNum":"   72","line":"      dictionary = Util.bip0039_word_list","class":"lineCov","hits":"1","order":"12","possible_hits":"1",},
{"lineNum":"   73","line":""},
{"lineNum":"   74","line":"      # get indices for each of the words and compute a checksummed seed"},
{"lineNum":"   75","line":"      checksummed_seed = \"\"","class":"lineCov","hits":"1","order":"18","possible_hits":"1",},
{"lineNum":"   76","line":"      phrase.each do |word|"},
{"lineNum":"   77","line":"        index = dictionary.index(word)","class":"lineCov","hits":"1","order":"19","possible_hits":"1",},
{"lineNum":"   78","line":"        raise \"Invalid seed phrase: word not in dictionary\" if index.nil?","class":"lineCov","hits":"2","order":"20","possible_hits":"2",},
{"lineNum":"   79","line":"        checksummed_seed += Util.num_to_padded_bin index, 11","class":"lineCov","hits":"1","order":"21","possible_hits":"1",},
{"lineNum":"   80","line":"      end"},
{"lineNum":"   81","line":""},
{"lineNum":"   82","line":"      # retrieve seed and checksum"},
{"lineNum":"   83","line":"      seed_length = (checksummed_seed.size * 32 / 33).to_i","class":"linePartCov","hits":"1","order":"25","possible_hits":"2",},
{"lineNum":"   84","line":"      checksum_length = checksummed_seed.size - seed_length","class":"lineCov","hits":"1","order":"26","possible_hits":"1",},
{"lineNum":"   85","line":"      seed = checksummed_seed[0, seed_length]","class":"lineCov","hits":"1","order":"27","possible_hits":"1",},
{"lineNum":"   86","line":"      checksum = checksummed_seed[seed_length, checksum_length]","class":"lineCov","hits":"1","order":"28","possible_hits":"1",},
{"lineNum":"   87","line":""},
{"lineNum":"   88","line":"      # not every phrase is valid, therefore we verify the checksum bits"},
{"lineNum":"   89","line":"      raise \"Invalid seed phrase: checksum mismatch\" if checksum != checksum Util.bin_to_padded_hex seed, seed.size","class":"lineCov","hits":"1","order":"29","possible_hits":"1",},
{"lineNum":"   90","line":""},
{"lineNum":"   91","line":"      # store the seed"},
{"lineNum":"   92","line":"      @ent = seed.size","class":"lineCov","hits":"1","order":"69","possible_hits":"1",},
{"lineNum":"   93","line":"      @seed = BigInt.new seed, 2","class":"lineCov","hits":"1","order":"70","possible_hits":"1",},
{"lineNum":"   94","line":"    end"},
{"lineNum":"   95","line":""},
{"lineNum":"   96","line":"    # generates a random seed of ENT bits entropy"},
{"lineNum":"   97","line":"    private def generate_random_seed(ent : Int32) : BigInt","class":"lineCov","hits":"1","order":"45","possible_hits":"1",},
{"lineNum":"   98","line":"      raise \"Invalid entropy provided\" if ent % 32 != 0","class":"lineCov","hits":"1","order":"46","possible_hits":"1",},
{"lineNum":"   99","line":"      seed = Random::Secure.hex (ent / 8).to_i","class":"lineCov","hits":"1","order":"47","possible_hits":"1",},
{"lineNum":"  100","line":"      return BigInt.new seed, 16","class":"lineCov","hits":"1","order":"48","possible_hits":"1",},
{"lineNum":"  101","line":"    end"},
{"lineNum":"  102","line":""},
{"lineNum":"  103","line":"    # generates a phrase of words according to the bip-39 specification"},
{"lineNum":"  104","line":"    def to_words : Array(String)","class":"lineCov","hits":"2","order":"51","possible_hits":"2",},
{"lineNum":"  105","line":""},
{"lineNum":"  106","line":"      # a checksum is generated by taking the first ENT / 32 bits of its SHA256 hash"},
{"lineNum":"  107","line":"      seed_hex = Util.num_to_padded_hex @seed, @ent","class":"lineCov","hits":"1","order":"52","possible_hits":"1",},
{"lineNum":"  108","line":"      checksum_bin = checksum seed_hex","class":"lineCov","hits":"1","order":"56","possible_hits":"1",},
{"lineNum":"  109","line":""},
{"lineNum":"  110","line":"      # this checksum is appended to the end of the initial entropy"},
{"lineNum":"  111","line":"      seed_bin = Util.num_to_padded_bin @seed, @ent","class":"lineCov","hits":"1","order":"57","possible_hits":"1",},
{"lineNum":"  112","line":"      checksummed_seed = seed_bin + checksum_bin","class":"lineCov","hits":"1","order":"58","possible_hits":"1",},
{"lineNum":"  113","line":""},
{"lineNum":"  114","line":"      # next, these concatenated bits are split into groups of 11 bits,"},
{"lineNum":"  115","line":"      # each encoding a number from 0-2047, serving as an index into a wordlist."},
{"lineNum":"  116","line":"      iterator = 0","class":"lineCov","hits":"1","order":"59","possible_hits":"1",},
{"lineNum":"  117","line":"      split_size = 11","class":"lineCov","hits":"1","order":"60","possible_hits":"1",},
{"lineNum":"  118","line":"      word_indices = [] of Int32","class":"lineCov","hits":"1","order":"61","possible_hits":"1",},
{"lineNum":"  119","line":"      while iterator < checksummed_seed.size","class":"lineCov","hits":"1","order":"62","possible_hits":"1",},
{"lineNum":"  120","line":"        word_indices << checksummed_seed[iterator, split_size].to_i(2)","class":"lineCov","hits":"1","order":"63","possible_hits":"1",},
{"lineNum":"  121","line":"        iterator += split_size","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  122","line":"      end"},
{"lineNum":"  123","line":""},
{"lineNum":"  124","line":"      # finally, we convert these numbers into words and use the joined words as a mnemonic sentence."},
{"lineNum":"  125","line":"      word_list = Util.bip0039_word_list","class":"lineCov","hits":"1","order":"64","possible_hits":"1",},
{"lineNum":"  126","line":"      phrase = [] of String","class":"lineCov","hits":"1","order":"65","possible_hits":"1",},
{"lineNum":"  127","line":"      word_indices.each do |index|"},
{"lineNum":"  128","line":"        phrase << word_list[index]","class":"lineCov","hits":"1","order":"66","possible_hits":"1",},
{"lineNum":"  129","line":"      end"},
{"lineNum":"  130","line":"      return phrase"},
{"lineNum":"  131","line":"    end"},
{"lineNum":"  132","line":""},
{"lineNum":"  133","line":"    def checksum (seed_hex : String) : String","class":"lineCov","hits":"1","order":"34","possible_hits":"1",},
{"lineNum":"  134","line":"      sha256sum_hex = OpenSSL::Digest.new(\"SHA256\").update(seed_hex.hexbytes).final.hexstring","class":"lineCov","hits":"1","order":"35","possible_hits":"1",},
{"lineNum":"  135","line":"      sha256sum_bin = Util.hex_to_padded_bin sha256sum_hex, 256","class":"lineCov","hits":"1","order":"36","possible_hits":"1",},
{"lineNum":"  136","line":"      checksum_length = (seed_hex.size / 8).to_i","class":"lineCov","hits":"1","order":"41","possible_hits":"1",},
{"lineNum":"  137","line":"      return sha256sum_bin[0, checksum_length]","class":"lineCov","hits":"1","order":"42","possible_hits":"1",},
{"lineNum":"  138","line":"    end"},
{"lineNum":"  139","line":""},
{"lineNum":"  140","line":"    # returns the seed as hex string"},
{"lineNum":"  141","line":"    def to_hex : String","class":"lineCov","hits":"2","order":"67","possible_hits":"2",},
{"lineNum":"  142","line":"      return Util.num_to_padded_hex @seed, @ent","class":"lineCov","hits":"1","order":"68","possible_hits":"1",},
{"lineNum":"  143","line":"    end"},
{"lineNum":"  144","line":"  end"},
{"lineNum":"  145","line":"end"},
]};
var percent_low = 25;var percent_high = 75;
var header = { "command" : "run_coverage", "date" : "2021-10-31 14:25:05", "instrumented" : 54, "covered" : 53,};
var merged_data = [];
